<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IPPL (Independent Parallel Particle Layer): LandauDamping</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">IPPL (Independent Parallel Particle Layer)
   </div>
   <div id="projectbrief">IPPL</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">LandauDamping </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >This is an example demonstrating the setup and execution of a Landau damping simulation using the IPPL framework.</p>
<h3><a class="anchor" id="autotoc_md39"></a>
Usage</h3>
<p >The executable can be run with the following command-line arguments: </p><div class="fragment"><div class="line">   srun ./LandauDamping &lt;nx&gt; [&lt;ny&gt;...] &lt;Np&gt; &lt;Nt&gt; &lt;stype&gt; &lt;lbthres&gt; &lt;tintegr&gt; --overallocate</div>
<div class="line">&lt;ovfactor&gt; --info 10</div>
</div><!-- fragment --><ul>
<li><b>nx</b>: Number of cell-centered points in the x-direction.</li>
<li><b>ny...</b>: Number of cell-centered points in the y-, z-, ...-direction.</li>
<li><b>Np</b>: Total number of macro-particles in the simulation.</li>
<li><b>Nt</b>: Number of time steps to execute.</li>
<li><b>stype</b>: Field solver type, with FFT and CG (Conjugate Gradient) being supported.</li>
<li><b>lbthres</b>: Load balancing threshold. For example, a value of 0.01 means load balancing occurs if the load imbalance exceeds 1%.</li>
<li><b>tintegr</b>: Type of time integrator. For example Leapfrog.</li>
<li><b>ovfactor</b>: Over-allocation factor for buffers used in communication. A value of 1.0 means no over-allocation.</li>
</ul>
<h3><a class="anchor" id="autotoc_md40"></a>
Example Command</h3>
<div class="fragment"><div class="line">srun ./LandauDamping 128 128 128 10000 10 FFT 0.01 LeapFrog --overallocate 2.0 --info 10</div>
</div><!-- fragment --><p> This command runs a simulation with a 128x128x128 grid, 10,000 particles, for 10 time steps, using the FFT solver, a load balancing threshold of 1%, with LeapFrog integration, overallocating buffers by a factor of 2.</p>
<h3><a class="anchor" id="autotoc_md41"></a>
Implementation Detail</h3>
<p >The main function initializes the Ippl framework, sets up the simulation parameters from command-line arguments, and then creates and configures an instance of <code><a class="el" href="classLandauDampingManager.html">LandauDampingManager</a></code> to manage the simulation. It performs pre-run operations to set up the simulation environment and then runs the simulation for the specified number of time steps. <a class="el" href="structTiming.html">Timing</a> information is collected and output for performance analysis. </p><div class="fragment"><div class="line"><span class="keyword">constexpr</span> <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="BumponTailInstability_8cpp.html#afef54e0ebfe65da0a396b342dcbe30f5">Dim</a> = 3;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="BumponTailInstability_8cpp.html#a6b2d038ea9c8d2651eecffe0e28b7ebb">T</a> = double;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code hl_variable" href="datatypes_8h.html#a17a8b6df8e098aa2526217331771b090">TestName</a> = <span class="stringliteral">&quot;LandauDamping&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="Ippl_8h.html">Ippl.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;Kokkos_MathematicalConstants.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Kokkos_MathematicalFunctions.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Kokkos_Random.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;random&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;set&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="datatypes_8h.html">datatypes.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="IpplTimings_8h.html">Utility/IpplTimings.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="LandauDampingManager_8h.html">LandauDampingManager.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="PicManager_8h.html">Manager/PicManager.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="BumponTailInstability_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div>
<div class="line">    <a class="code hl_function" href="namespaceippl.html#a0c7376f5476bb172361c963569a0c546">ippl::initialize</a>(argc, argv);</div>
<div class="line">    {</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="classInform.html">Inform</a> msg(<a class="code hl_variable" href="datatypes_8h.html#a17a8b6df8e098aa2526217331771b090">TestName</a>);</div>
<div class="line">        <a class="code hl_class" href="classInform.html">Inform</a> msg2all(<a class="code hl_variable" href="datatypes_8h.html#a17a8b6df8e098aa2526217331771b090">TestName</a>, <a class="code hl_define" href="Inform_8h.html#a92f1a0cddb2239428b24e94b918e4efb">INFORM_ALL_NODES</a>);</div>
<div class="line">        <span class="keyword">static</span> <a class="code hl_typedef" href="classIpplTimings.html#a06ab8330445cb281b26fa12dbfa2b72c">IpplTimings::TimerRef</a> mainTimer = <a class="code hl_function" href="classIpplTimings.html#a59ffa7a04c160376d3a6593bff568fb4">IpplTimings::getTimer</a>(<span class="stringliteral">&quot;total&quot;</span>);</div>
<div class="line">        <a class="code hl_function" href="classIpplTimings.html#af9d914cab7e60b310cb44c75c8bff228">IpplTimings::startTimer</a>(mainTimer);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//Parses command-line arguments to set up simulation parameters.</span></div>
<div class="line"><span class="comment">// This segment of code iterates through the command-line arguments provided to the application,</span></div>
<div class="line"><span class="comment">// assigning each parameter to the corresponding variable. These parameters define the</span></div>
<div class="line"><span class="comment">// simulation&#39;s grid size, number of particles, number of time steps, solver type, load balancing</span></div>
<div class="line"><span class="comment">// threshold, and overallocation factor.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line">        <span class="keywordtype">int</span> arg = 1;</div>
<div class="line">        <a class="code hl_class" href="classippl_1_1Vector.html">Vector_t&lt;int, Dim&gt;</a> nr;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d = 0; d &lt; <a class="code hl_variable" href="BumponTailInstability_8cpp.html#afef54e0ebfe65da0a396b342dcbe30f5">Dim</a>; d++) {</div>
<div class="line">            nr[d] = std::atoi(argv[arg++]);</div>
<div class="line">        }</div>
<div class="line">        <a class="code hl_typedef" href="datatypes_8h.html#a117948da4a7f2c353ea5ef900c1762c4">size_type</a> totalP = std::atoll(argv[arg++]);</div>
<div class="line">        <span class="keywordtype">int</span> nt  = std::atoi(argv[arg++]);</div>
<div class="line">        std::string solver = argv[arg++];</div>
<div class="line">        <span class="keywordtype">double</span> lbt = std::atof(argv[arg++]);</div>
<div class="line">        std::string step_method = argv[arg++];</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Sets up and executes the Landau damping simulation.</span></div>
<div class="line"><span class="comment">//  After parsing the input parameters, this code initializes the LandauDampingManager with the</span></div>
<div class="line"><span class="comment">//  specified configuration. It then calls pre_run to prepare the simulation environment, sets</span></div>
<div class="line"><span class="comment">//  the simulation start time, and executes the simulation for the defined number of time steps.</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Create an instance of a manger for the considered application</span></div>
<div class="line">        <a class="code hl_class" href="classLandauDampingManager.html">LandauDampingManager&lt;T, Dim&gt;</a> manager(totalP, nt, nr, lbt, solver, step_method);</div>
<div class="line">        <span class="comment">// Perform pre-run operations, including creating mesh, particles,...</span></div>
<div class="line">        manager.pre_run();</div>
<div class="line">        manager.setTime(0.0);</div>
<div class="line">        msg &lt;&lt; <span class="stringliteral">&quot;Starting iterations ...&quot;</span> &lt;&lt; <a class="code hl_function" href="Inform_8cpp.html#ab8fcb5b7d232d8e390b36e1e8491b236">endl</a>;</div>
<div class="line">        manager.run(manager.getNt());</div>
<div class="line">        msg &lt;&lt; <span class="stringliteral">&quot;End.&quot;</span> &lt;&lt; <a class="code hl_function" href="Inform_8cpp.html#ab8fcb5b7d232d8e390b36e1e8491b236">endl</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//Collects timing information and finalizes the simulation.</span></div>
<div class="line"><span class="comment">//  Marks the end of the simulation execution, stops the main timer, and outputs timing</span></div>
<div class="line"><span class="comment">//  information. This helps in analyzing the performance of the simulation. Finally, it</span></div>
<div class="line"><span class="comment">//  calls `ippl::finalize()` to clean up the Ippl framework and gracefully exit the application.</span></div>
<div class="line"> </div>
<div class="line">        <a class="code hl_function" href="classIpplTimings.html#a8b229ce711198a6e0e190e7d9098c3eb">IpplTimings::stopTimer</a>(mainTimer);</div>
<div class="line">        <a class="code hl_function" href="classIpplTimings.html#acba34e31a0e087487a086b55fd543e79">IpplTimings::print</a>();</div>
<div class="line">        <a class="code hl_function" href="classIpplTimings.html#acba34e31a0e087487a086b55fd543e79">IpplTimings::print</a>(std::string(<span class="stringliteral">&quot;timing.dat&quot;</span>));</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_function" href="namespaceippl.html#a2067813c0b17952b7d4acb23587c1df2">ippl::finalize</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aBumponTailInstability_8cpp_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="BumponTailInstability_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> BumponTailInstability.cpp:45</div></div>
<div class="ttc" id="aBumponTailInstability_8cpp_html_a6b2d038ea9c8d2651eecffe0e28b7ebb"><div class="ttname"><a href="BumponTailInstability_8cpp.html#a6b2d038ea9c8d2651eecffe0e28b7ebb">T</a></div><div class="ttdeci">double T</div><div class="ttdef"><b>Definition:</b> BumponTailInstability.cpp:23</div></div>
<div class="ttc" id="aBumponTailInstability_8cpp_html_afef54e0ebfe65da0a396b342dcbe30f5"><div class="ttname"><a href="BumponTailInstability_8cpp.html#afef54e0ebfe65da0a396b342dcbe30f5">Dim</a></div><div class="ttdeci">constexpr unsigned Dim</div><div class="ttdef"><b>Definition:</b> BumponTailInstability.cpp:22</div></div>
<div class="ttc" id="aInform_8cpp_html_ab8fcb5b7d232d8e390b36e1e8491b236"><div class="ttname"><a href="Inform_8cpp.html#ab8fcb5b7d232d8e390b36e1e8491b236">endl</a></div><div class="ttdeci">Inform &amp; endl(Inform &amp;inf)</div><div class="ttdef"><b>Definition:</b> Inform.cpp:42</div></div>
<div class="ttc" id="aInform_8h_html_a92f1a0cddb2239428b24e94b918e4efb"><div class="ttname"><a href="Inform_8h.html#a92f1a0cddb2239428b24e94b918e4efb">INFORM_ALL_NODES</a></div><div class="ttdeci">#define INFORM_ALL_NODES</div><div class="ttdef"><b>Definition:</b> Inform.h:38</div></div>
<div class="ttc" id="aIpplTimings_8h_html"><div class="ttname"><a href="IpplTimings_8h.html">IpplTimings.h</a></div></div>
<div class="ttc" id="aIppl_8h_html"><div class="ttname"><a href="Ippl_8h.html">Ippl.h</a></div></div>
<div class="ttc" id="aLandauDampingManager_8h_html"><div class="ttname"><a href="LandauDampingManager_8h.html">LandauDampingManager.h</a></div></div>
<div class="ttc" id="aPicManager_8h_html"><div class="ttname"><a href="PicManager_8h.html">PicManager.h</a></div></div>
<div class="ttc" id="aclassInform_html"><div class="ttname"><a href="classInform.html">Inform</a></div><div class="ttdef"><b>Definition:</b> Inform.h:40</div></div>
<div class="ttc" id="aclassIpplTimings_html_a06ab8330445cb281b26fa12dbfa2b72c"><div class="ttname"><a href="classIpplTimings.html#a06ab8330445cb281b26fa12dbfa2b72c">IpplTimings::TimerRef</a></div><div class="ttdeci">Timing::TimerRef TimerRef</div><div class="ttdef"><b>Definition:</b> IpplTimings.h:144</div></div>
<div class="ttc" id="aclassIpplTimings_html_a59ffa7a04c160376d3a6593bff568fb4"><div class="ttname"><a href="classIpplTimings.html#a59ffa7a04c160376d3a6593bff568fb4">IpplTimings::getTimer</a></div><div class="ttdeci">static TimerRef getTimer(const char *nm)</div><div class="ttdef"><b>Definition:</b> IpplTimings.h:150</div></div>
<div class="ttc" id="aclassIpplTimings_html_a8b229ce711198a6e0e190e7d9098c3eb"><div class="ttname"><a href="classIpplTimings.html#a8b229ce711198a6e0e190e7d9098c3eb">IpplTimings::stopTimer</a></div><div class="ttdeci">static void stopTimer(TimerRef t)</div><div class="ttdef"><b>Definition:</b> IpplTimings.h:156</div></div>
<div class="ttc" id="aclassIpplTimings_html_acba34e31a0e087487a086b55fd543e79"><div class="ttname"><a href="classIpplTimings.html#acba34e31a0e087487a086b55fd543e79">IpplTimings::print</a></div><div class="ttdeci">static void print()</div><div class="ttdef"><b>Definition:</b> IpplTimings.h:165</div></div>
<div class="ttc" id="aclassIpplTimings_html_af9d914cab7e60b310cb44c75c8bff228"><div class="ttname"><a href="classIpplTimings.html#af9d914cab7e60b310cb44c75c8bff228">IpplTimings::startTimer</a></div><div class="ttdeci">static void startTimer(TimerRef t)</div><div class="ttdef"><b>Definition:</b> IpplTimings.h:153</div></div>
<div class="ttc" id="aclassLandauDampingManager_html"><div class="ttname"><a href="classLandauDampingManager.html">LandauDampingManager</a></div><div class="ttdef"><b>Definition:</b> LandauDampingManager.h:46</div></div>
<div class="ttc" id="aclassippl_1_1Vector_html"><div class="ttname"><a href="classippl_1_1Vector.html">ippl::Vector</a></div><div class="ttdef"><b>Definition:</b> Vector.h:23</div></div>
<div class="ttc" id="adatatypes_8h_html"><div class="ttname"><a href="datatypes_8h.html">datatypes.h</a></div></div>
<div class="ttc" id="adatatypes_8h_html_a117948da4a7f2c353ea5ef900c1762c4"><div class="ttname"><a href="datatypes_8h.html#a117948da4a7f2c353ea5ef900c1762c4">size_type</a></div><div class="ttdeci">ippl::detail::size_type size_type</div><div class="ttdef"><b>Definition:</b> datatypes.h:23</div></div>
<div class="ttc" id="adatatypes_8h_html_a17a8b6df8e098aa2526217331771b090"><div class="ttname"><a href="datatypes_8h.html#a17a8b6df8e098aa2526217331771b090">TestName</a></div><div class="ttdeci">const char * TestName</div><div class="ttdef"><b>Definition:</b> BumponTailInstability.cpp:24</div></div>
<div class="ttc" id="anamespaceippl_html_a0c7376f5476bb172361c963569a0c546"><div class="ttname"><a href="namespaceippl.html#a0c7376f5476bb172361c963569a0c546">ippl::initialize</a></div><div class="ttdeci">void initialize(int &amp;argc, char *argv[], MPI_Comm comm)</div><div class="ttdef"><b>Definition:</b> Ippl.cpp:16</div></div>
<div class="ttc" id="anamespaceippl_html_a2067813c0b17952b7d4acb23587c1df2"><div class="ttname"><a href="namespaceippl.html#a2067813c0b17952b7d4acb23587c1df2">ippl::finalize</a></div><div class="ttdeci">void finalize()</div><div class="ttdef"><b>Definition:</b> Ippl.cpp:100</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
